<?xml version="1.0" encoding="UTF-8"?> 
<!DOCTYPE mapper PUBLIC 
	"-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="review_mapper">

	<select id="findReviewListByUserCode" parameterType="int" resultType="Review">
		SELECT ur.review_code review_code, ur.user_code user_code, ur.acm_code acm_code,
        	ur.room_code room_code, ur.rating rating, ur.review_text review_text,
        	TO_CHAR(ur.review_date, 'YYYY/MM/DD HH:MI') review_date, ur.reply_exists reply_exists,
        	acm.acm_name acm_name, r.room_name || ' ' || r.room_type room_name
		FROM user_review ur
		INNER JOIN accommodation acm
		ON ur.acm_code = acm.acm_code
		INNER JOIN room r
		ON ur.room_code = r.room_code
		WHERE user_code = #{userCode}
		AND report_status != 2
		ORDER BY review_date DESC
	</select>
	
	<select id="findReviewImgListByReviewCode" parameterType="int" resultType="ReviewImg">
		SELECT * FROM review_img
		WHERE review_code = #{reviewCode}
	</select>
	
</mapper>